let wrapper=document.querySelectorAll(".wrapper"),cart=document.getElementById("cart");function addEvent(t,e,n){return t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,function(){n.call(t)}),!1}function addToCart(t){this.disabled=!0;let e=getCartData()||{},n=this.parentNode.parentNode,r=this.getAttribute("data-id"),a=n.querySelector(".wrapper__title").innerHTML,c=n.querySelector(".wrapper__price").innerHTML,l=n.querySelector(".wrapper__counter");return e.hasOwnProperty(r)?e[r][2]+=1:e[r]=[a,c,1],l.innerHTML=e[r][2],setCartData(e)||(this.disabled=!1),drawTable(),!1}for(let t=0;t<wrapper.length;t++)addEvent(wrapper[t].querySelector(".wrapper__btn"),"click",addToCart);function openCart(t){cart.classList.contains("close")?cart.classList.toggle("close"):cart.classList.add("close");getCartData();return drawTable(),!1}function drawTable(){let t=getCartData(),e="";if(null!==t&&Object.keys(t).length>0){e='<table style="display: flex" class="shopping__list">\n  <tr>\n    <th>Наименование</th>\n    <th>Цена</th>\n    <th>Кол-во</th>\n  </tr>';let n=0;for(let r in t)n+=parseFloat(t[r][1])*t[r][2],e+="<tr>",e+=`<td>${t[r][0]}</td>`,e+=`<td>${t[r][1]}</td>`,e+=`<td>\n  <button class="btn-minus" name="remove" onclick="cartQuantityAction(${r}, 'minus')">-</button>\n  ${t[r][2]}\n  <button class="btn-plus" name="adding" onclick="cartQuantityAction(${r}, 'plus')">+</button>\n</td>`,e+="</tr>";e+="</table>",e+=`<div class="page-section__total">Итого: ${n}</div>`,cart.innerHTML=e}else cart.innerHTML="В корзине пусто!"}function cartQuantityAction(t,e){let n=getCartData();"plus"===e?n[t][2]+=1:"minus"===e&&(n[t][2]-=1),setCounter(t,n[t][2]),0===n[t][2]&&delete n[t],setCartData(n),drawTable()}function setCounter(t,e){let n=document.querySelector(`[data-id='${t}']`).parentNode.querySelector(".wrapper__counter");n.innerHTML=0===e?"":e,console.log(n)}quantity=document.querySelector(".cart-quantity"),addEvent(document.getElementById("checkout"),"click",openCart),addEvent(document.getElementById("clear_cart"),"click",function(t){localStorage.removeItem("cart"),cart.innerHTML="Корзина очищена.",document.querySelectorAll(".wrapper__counter").forEach(function(t){t.innerHTML=""})});